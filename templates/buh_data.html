<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <meta name="theme-color" content="#000000">

    <title>–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</title>
    <link rel="shortcut icon" href="../static/images/jruby.svg">



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../static/bootstrap.css">
    <link rel="stylesheet" href="../static/custom_style.css">
    <link rel="stylesheet" href="../static/select2.min.css">
    <script type=text/javascript src="{{ url_for('static', filename='js/jquery-3.7.1.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bootstrap.bundle.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bad_scripts.js') }}"></script>
    <script src="{{ url_for('static', filename='js/save_&_delete.js') }}"></script>
    <script src="{{ url_for('static', filename='js/to_fill_modals.js') }}"></script>
    <script src="{{ url_for('static', filename='js/table-sort.js') }}"></script>
    
    
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
        {# document.getElementById("Input_for_buh_data_serch").value = JSON.parse(localStorage.getItem("serch")); #}
        {# buh_data_table_serch() #}
        {# localStorage.clear() #}
        document.documentElement.setAttribute('data-bs-theme',JSON.parse(localStorage.getItem("colar_thema")))
        const table = document.getElementById('buh_data_tbody')
        const tbodies = table.getElementsByTagName('table');
        document.getElementById('number_of_records').innerHTML= '–ó–∞–ø–∏—Å–µ–π –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–æ: ' + tbodies.length ;  
        });
    </script> 
    

</head>
<body>
    <div class="modal fade" id="add_new_inv_number_Modal" data-bs-backdrop="static" role="dialog" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="AddNewUnits">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤   </h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" ></button>
            </div>
             <div class="modal-body">
                <table class="table table-sm " id="buh_data_table">                
                    <tbody class="table-condensed " >
                    <tr><td id ="td_for_new_table">
                            <table class="table table-sm table-bordered table-hover borderd_table" id = "new_inv_namber_table">
                                    <tbody >
                                        <tr>
                                            <td width = '18%' contenteditable><i>–ò–Ω–≤–µ–Ω—Ç–∞—Ä–Ω—ã–π –Ω–æ–º–µ—Ä</i></td>
                                            <td contenteditable><i>–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</i></td>
                                            <td width = '18%' >{{ user_name }} </td>      
                                        </tr> 
                                        <tr>
                                            <td contenteditable colspan = '3'><i>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞</i></td>
                                        </tr>
                                    </tbody> 
                            </table>
                    </td></tr>
                    </tbody>
                </table>

            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary" id="button_add_new_row" onclick="add_new_table('td_for_new_table',this.name)" data-toggle="tooltip" data-placement="top" title="–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É">
                  <i class="bi bi-plus-lg"></i>
              </button>
                <button type="button" class="btn btn-primary" id="button_del_row" onclick="del_new_table('td_for_new_table')" data-toggle="tooltip" data-placement="top" title="–£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É">
                    <i class="bi bi-dash-lg"></i>
                </button>
              <button type="button" class="btn btn-primary" id="button_for_save_new_units" onclick="add_new_inv_numbers('td_for_new_table', this.id)" data-toggle="tooltip" data-placement="top" title="–î–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="reload_page()" >–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
          </div>
        </div>
    </div>
    <div class="modal fade" id="inventModal" data-bs-backdrop="static" role="dialog" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="inventModalLabel">–ö–∞—Ä—Ç–æ—á–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <form>
                <label class="col-form-label" id="id_buh"></label>
            <div class="container">
                <div class="row">
                    <div class="col-sm">
                    <div class="mb-3">
                        <label class="col-form-label">–ò–Ω–≤–µ–Ω—Ç–∞—Ä–Ω—ã–π –Ω–æ–º–µ—Ä:</label>
                        <input type="text" readonly class="form-control" name="name" id = "In_num">
                    </div>
                    </div>
                    <div class="col-sm">
                    <div class="mb-3">
                        <label class="col-form-label">–ú–û–õ:</label>
                        
                        <select class="form-select" aria-label="Default select example" id = 'select_mol_id'>
                            {% for mol in mols %}
                                <option value="{{ mol.id }}">{{ mol.full_name }}</option>
                            {% endfor %}
                            
                        </select>    
                    </div>
                    </div>
                </div>
            </div>
            <div class="mb-3">
                <label class="col-form-label">–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:</label>
                <input type="text"  class="form-control" id="description_id">
            </div>
            <div class="mb-3">
                <label  class="col-form-label">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞:</label>
                <textarea  class="form-control" id="char_id" cols="30" rows="7"></textarea>
            </div>
            <div class="mb-3">
                <label  class="col-form-label">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</label>
                <textarea  class="form-control" id="note_id" cols="30" rows="3"></textarea>
            </div>
                </form>
        </div>
        <div class="modal-footer">
            
            <button type="button" class="btn btn-primary" id = "button_for_save_edit_buh_data" onclick="save_edit_buh_data()" data-toggle="tooltip" data-placement="top" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button type="button" class="btn btn-primary" id="button_for_delete_inv_number" data-toggle="tooltip" data-placement="top" title="–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å">–£–¥–∞–ª–∏—Ç—å</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id = 'close_btn_id'>–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
        </div>
    </div>
    </div>
    <div class="modal" id="Change_pass"  data-bs-backdrop="static" role="dialog" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="mb-3">
                <input type="password"  class="form-control"  id = "old_pass_id" placeholder="–°—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å">
            </div>
            <div class="mb-3">
                <input type="password"  class="form-control" id="new_pass_id" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å, –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤">
            </div>
            <div class="mb-3">
                <input type="password"  class="form-control" id="new_pass_2_id" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –ø–∞–≤—Ç–æ—Ä–Ω–æ">
            </div>
            <div class="mb-3">
                <label class="col-form-label" id="raport_chang_pass"></label>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="change_password();">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
        </div>
        </div>
    </div>
    </div>
    <script type="text/javascript">
                $('#inventModal').on('show.bs.modal', function (e) {
                $(this).find('form').trigger('reset');
                invent_modal($(e.relatedTarget).data('inv'));
                console.log("üöÄ ~ e.relatedTarget.data('id'):", $(e.relatedTarget).data('id'))
                document.getElementById('button_for_delete_inv_number').setAttribute('class',"btn btn-primary");
                document.getElementById('button_for_delete_inv_number').onclick = function (){delete_table('BuhUch', $(e.relatedTarget).data('id'),this.id)};
                
                })
                $('#Change_pass').on('show.bs.modal', function (e) {
                $(this).find('form').trigger('reset');
                document.getElementById("raport_chang_pass").textContent = ""
                })
                document.getElementById('new_inv_namber_table').addEventListener('click', (e) => {
                    if (e.target.tagName === "I"){e.target.remove()}                                                                 
                });
                
                document.getElementById('button_add_new_row').setAttribute('name','{{ user_name | tojson }}');
                $(function () {
                    $('[data-toggle="tooltip"]').tooltip()
                })
    </script>


    <header class="navbar sticky-top bg-dark flex-md-nowrap p-0 shadow" data-bs-theme="dark">
        <div class="d-grid gap-2 d-md-flex float-left">
        <a href="" data-bs-toggle="offcanvas" data-bs-target="#offcanvasWithBothOptions" aria-controls="offcanvasWithBothOptions" style="display: inline-block;" class="icon-link">
            <i class="bi bi-list h2 castom-white"></i>
        </a>
        <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6 text-white" href="#">–ì–æ–º–µ–ª—å—Å–∫–∏–π –ó–£–≠–°</a>
        </div>
        <li class="nav-item dropdown nav justify-content-end">
            <a class="nav-link dropdown-toggle text-white nav justify-content-end" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">{{ user_name }}    </a>
            <ul class="dropdown-menu dropdown-menu-end">
                <li><a class="dropdown-item" id="switch_to_dark_mod" href="#">–¢–µ–º–∞</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#Change_pass" href="#">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="/logout">–í—ã–π—Ç–∏</a></li>                               
            </ul>
        </li>
    </header>
    <script type="text/javascript">
        document.getElementById('switch_to_dark_mod').addEventListener('click',()=>{
            if (document.documentElement.getAttribute('data-bs-theme') == 'dark') {
                document.documentElement.setAttribute('data-bs-theme','light')
                localStorage.setItem("colar_thema",JSON.stringify('light'));
            }
            else {
                document.documentElement.setAttribute('data-bs-theme','dark')
                localStorage.setItem("colar_thema",JSON.stringify('dark'));
            }
        })
    </script>
    <div class="offcanvas offcanvas-start" data-bs-scroll="true" tabindex="-1" id="offcanvasWithBothOptions" aria-labelledby="offcanvasWithBothOptionsLabel">
        <div class="offcanvas-header">
        </div>
        <div class="offcanvas-body">
            <form>
                <div class="d-grid gap-3">
                    <button class="btn btn-primary" type="submit" formaction="/pon_units" >–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ PON</button>
                    <button class="btn btn-primary" type="submit" formaction="/multiple_access" >–ú–Ω–æ–≥–æ–ø–æ—Ä—Ç–æ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–æ—Å—Ç—É–ø–∞</button>
                    <button class="btn btn-secondary" type="submit" disabled formaction="/buh_data" >–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</button>      
                    <button class="btn btn-primary" type="submit" disabled formaction="/other_property">–ü—Ä–æ—á–µ–µ –∏–º—É—â–µ—Å—Ç–≤–æ</button>
                </div>            
                </form>
        </div>
    </div>
    <div class="container-fluid">
    <div class="row">
        <div class="col" ></div>
        <div class="col-8">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h2">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</h1>
            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <button type="button" class="btn btn-primary btn-lg"  data-bs-toggle="modal" data-bs-target="#add_new_inv_number_Modal" data-toggle="tooltip" data-placement="bottom" title="–û–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π" >
                    <i class="bi bi-plus-square-fill"></i>  –î–æ–±–∞–≤–∏—Ç—å</button>
                    <button type="button" class="btn btn-primary btn-lg" onclick="save_buh_data_table_in_file()" data-toggle="tooltip" data-placement="bottom" title="–°–∫–∞—á—Å—Ç—å —Ñ–∞–π–ª —Å —Ç–µ–∫—É—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏">
                    <i class="bi bi-download"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ Excel</button>
                </div></div>
                <div class="table-responsive small">
                    <div class="container text-start">
                         <div class="row ">
                            <div class="col">
                                <div class="container-fluid">
                                    <input  class ="input_for_serch" type="text" id="Input_for_buh_data_serch" onkeyup="buh_data_table_serch()" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–Ω–æ–º—É –Ω–æ–º–µ—Ä—É..." autocomplete="off" readonly onfocus="this.removeAttribute('readonly')" >
                                </div>
                            </div>
                         </div>
                       
                        <div class="row">
                            <div class="col-md-auto">
                                <div class="row row-cols-auto">
                                    <div class="col text-start">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="" id="flexCheck_main">
                                            <label class="form-check-label" >–û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ</label>  
                                        </div>
                                    </div>
                                    <div class="col text-start">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckChecked">
                                            <label class="form-check-label" for="flexSwitchCheckChecked">–û—Ç–æ–±—Ä–æ–∑–∏—Ç—å –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ</label>
                                        </div>
                                    </div>
                                    <div class="col div-change-clr">
                                        <input class="btn-change-clr" type="color" list="colors" id="favcolor" data-toggle="tooltip" data-placement="bottom" title="–í—ã–¥–µ–ª–∏—Ç—å —Ü–≤–µ—Ç–æ–º" value="#83b3fb"/>
                                            <datalist id="colors">
                                                <option value="#83b3fa" label="table-primary">
                                                <option value="#ace6f3" label="table-info">
                                                <option value="#87ddb6" label="table-success">
                                                <option value="#f5abb1" label="table-danger">
                                                <option value="#f7e098" label="table-warning">
                                            </datalist>
                                    </div>
                                    <div class="col div-change-clr">
                                        <input class= 'btn-change-clr' type="button" data-toggle="tooltip" data-placement="bottom" title="–£–±—Ä–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ" id="defolt_color"/>
                                    </div>
                                    <div class="col">
                                        <a href = "" id="delete_checked">–£–¥–∞–ª–∏—Ç—å –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ</a>
                                    </div>
                                </div>
                            </div>   
                            <div class="col">
                                <div class="row">
                                    <div class="col text-end" >
                                        <i id = 'number_of_records'> </i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                        <script type="text/javascript">
                        document.getElementById('flexCheck_main').addEventListener("change", function() {
                            if (this.checked) {
                                
                                check_all_visible(true)
                            } else {
                                check_all_visible(false);
                            }        
                        });
                        document.getElementById('flexSwitchCheckChecked').addEventListener("change", function() {
                            if (this.checked) {
                            
                                show_checked(true)
                            } else {
                                show_checked(false);
                            }        
                        });
                        document.getElementById('favcolor').addEventListener("change", function() {
                            console.log(this.value)
                            set_custom_bg_color(true,this.value)        
                        });
                        document.getElementById('defolt_color').addEventListener("click", function() {
                            console.log(this.value)
                            set_custom_bg_color(false)        
                        });
                        document.getElementById('delete_checked').addEventListener("click", function(e) {
                            e.preventDefault();
                            let table = document.getElementById('buh_data_tbody');
                            let tbodies = table.getElementsByTagName('table');
                            if(confirm('–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ?')){
                                for(var i = 0; i < tbodies.length; i++){
                                tds = tbodies[i].getElementsByTagName('td');
                                if(tds[0].querySelector('.form-check-input').checked===true){
                                    delete_table_list('BuhUch',tds[1].querySelector('a').dataset.id)            
                                }
                            }
                            }
                            
                        });
                        </script>
                </div>
                <table class="table table-sm " id="buh_data_table">                
                    <tbody class="table-condensed " id="buh_data_tbody">
                    <tr><td id="td_for_buh_data_tables">
                        {% for buh in buh_data %} 
                            {% if buh.list_of_MOLs.full_name == user_name %} 
                                    <table  class="table table-sm table-bordered table-hover borderd_table"  id = "inv_number_id_{{buh.id}}" bgcolor = "{{ buh.color }}">
                                    <tbody>
                                        <tr>
                                            <td width = '2%'>
                                            
                                                <input class="form-check-input" type="checkbox" value="" id="flexCheck_{{ buh.id }}">
                                            
                                            </td>
                                            <td width = '18%'>–ò–Ω–≤. ‚Ññ:  <a href="" data-bs-toggle="modal" data-bs-target="#inventModal" data-id = "{{ buh.id }}" data-inv = "{{ buh.inv_number }}" >{{ buh.inv_number }}</a></td>
                                            <td >{{ buh.name }}</td>
                                            <td width = '18%'>–ú–û–õ: {{ buh.list_of_MOLs.full_name }}</td>      
                                        </tr> 
                                        <tr>
                                            <td class="multiline" colspan = '3'>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞: {{ buh.charracter }}</td>
                                            <td>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: {{ buh.note }}</td>
                                        </tr>
                                        
                                    </tbody>
                                    
                                </table>
                            {% endif %}                                                   
                        {% endfor %}
                    </td></tr>
                    </tbody>
                </table>
            </div>
            <div class="col" ></div>     
    </div>
    </div>
</body>

